---
import MarketingLayout from "../layouts/MarketingLayout.astro";

const rateLimits = [
  { tier: "Free", limit: "—", workflows: "—", storage: "—" },
  { tier: "Starter", limit: "60/min", workflows: "✓", storage: "✓" },
  { tier: "Pro", limit: "300/min", workflows: "✓", storage: "✓" },
  { tier: "Enterprise", limit: "Custom", workflows: "✓", storage: "✓" },
];
---

<MarketingLayout
  title="API"
  description="Programmatic access to FloImg workflows. Execute workflows, manage storage, and automate image pipelines without managing AI provider keys."
>
  <!-- Hero -->
  <section class="hero-section">
    <div class="hero-container">
      <div class="hero-badge">
        <svg
          class="badge-icon"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path>
          <polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
        </svg>
        Paid Feature
      </div>

      <h1 class="hero-title">
        Programmatic <span class="highlight">Image Workflows</span>
      </h1>

      <p class="hero-subtitle">
        Execute FloImg workflows via REST API. Automate image pipelines, integrate with your
        applications, and let FloImg handle AI provider credentials.
      </p>

      <div class="hero-ctas">
        <a href="/docs/api" class="cta-primary">View API Docs</a>
        <a href="/pricing" class="cta-secondary">See Pricing</a>
      </div>
    </div>
  </section>

  <!-- What You Can Do -->
  <section class="features-section">
    <div class="section-container">
      <h2 class="section-title">What You Can Do</h2>

      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
          </div>
          <h3>Execute Workflows</h3>
          <p>
            Run any workflow programmatically. Pass parameters, receive results. Same deterministic
            transforms, accessible via HTTP.
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path
                d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
              ></path>
              <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
              <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
          </div>
          <h3>Manage Storage</h3>
          <p>
            Upload, list, and retrieve images from your FloImg storage. Organize assets across
            projects with a simple REST interface.
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
          </div>
          <h3>No Key Management</h3>
          <p>
            FloImg manages API keys for OpenAI, Anthropic, and other providers. You get a single
            FloImg API key—we handle the rest.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Code Examples -->
  <section class="code-section">
    <div class="section-container">
      <h2 class="section-title">Simple Integration</h2>
      <p class="section-subtitle">Execute workflows with a single HTTP request</p>

      <div class="code-tabs">
        <div class="tab-buttons">
          <button class="tab-btn active" data-tab="curl">cURL</button>
          <button class="tab-btn" data-tab="typescript">TypeScript</button>
        </div>

        <div class="code-block" id="curl-tab">
          <pre><code><span class="code-comment"># Execute a workflow</span>
curl -X POST https://api.floimg.com/v1/workflows/execute \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '&#123;
    "workflowId": "wf_abc123",
    "parameters": &#123;
      "prompt": "A serene mountain landscape at sunset",
      "width": 1200,
      "height": 630
    &#125;
  &#125;'

<span class="code-comment"># Response</span>
&#123;
  "executionId": "exec_xyz789",
  "status": "completed",
  "output": &#123;
    "url": "https://storage.floimg.com/images/abc123.png",
    "width": 1200,
    "height": 630
  &#125;
&#125;</code></pre>
        </div>

        <div class="code-block hidden" id="typescript-tab">
          <pre><code><span class="code-keyword">const</span> response = <span class="code-keyword">await</span> fetch(
  <span class="code-string">'https://api.floimg.com/v1/workflows/execute'</span>,
  &#123;
    method: <span class="code-string">'POST'</span>,
    headers: &#123;
      <span class="code-string">'Authorization'</span>: <span class="code-string">`Bearer $&#123;apiKey&#125;`</span>,
      <span class="code-string">'Content-Type'</span>: <span class="code-string">'application/json'</span>,
    &#125;,
    body: JSON.stringify(&#123;
      workflowId: <span class="code-string">'wf_abc123'</span>,
      parameters: &#123;
        prompt: <span class="code-string">'A serene mountain landscape at sunset'</span>,
        width: <span class="code-number">1200</span>,
        height: <span class="code-number">630</span>,
      &#125;,
    &#125;),
  &#125;
);

<span class="code-keyword">const</span> result = <span class="code-keyword">await</span> response.json();
console.log(result.output.url);
<span class="code-comment">// https://storage.floimg.com/images/abc123.png</span></code></pre>
        </div>
      </div>
    </div>
  </section>

  <!-- Rate Limits -->
  <section class="limits-section">
    <div class="section-container">
      <h2 class="section-title">Rate Limits by Plan</h2>
      <p class="section-subtitle">API access starts at $10/month with the Starter plan</p>

      <div class="limits-table-wrapper">
        <table class="limits-table">
          <thead>
            <tr>
              <th>Plan</th>
              <th>Rate Limit</th>
              <th>Workflow Execution</th>
              <th>Storage API</th>
            </tr>
          </thead>
          <tbody>
            {
              rateLimits.map((row) => (
                <tr>
                  <td class="tier-name">{row.tier}</td>
                  <td>{row.limit}</td>
                  <td class={row.workflows === "✓" ? "check" : "dash"}>{row.workflows}</td>
                  <td class={row.storage === "✓" ? "check" : "dash"}>{row.storage}</td>
                </tr>
              ))
            }
          </tbody>
        </table>
      </div>

      <p class="limits-note">
        Rate limits are per-minute. Requests over the limit receive a 429 response with retry-after
        header.
      </p>
    </div>
  </section>

  <!-- CTA -->
  <section class="cta-section">
    <div class="section-container">
      <h2 class="cta-title">Ready to Integrate?</h2>
      <p class="cta-subtitle">
        Start with the Starter plan at $10/month, or explore the API docs first.
      </p>
      <div class="cta-buttons">
        <a href="/docs/api" class="cta-primary">View API Docs</a>
        <a href="/pricing" class="cta-secondary">See Pricing</a>
      </div>
    </div>
  </section>
</MarketingLayout>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const tabBtns = document.querySelectorAll(".tab-btn");
    const curlTab = document.getElementById("curl-tab");
    const tsTab = document.getElementById("typescript-tab");

    tabBtns.forEach((btn) => {
      btn.addEventListener("click", () => {
        tabBtns.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        const tab = btn.getAttribute("data-tab");
        if (tab === "curl") {
          curlTab?.classList.remove("hidden");
          tsTab?.classList.add("hidden");
        } else {
          curlTab?.classList.add("hidden");
          tsTab?.classList.remove("hidden");
        }
      });
    });
  });
</script>

<style>
  /* Hero */
  .hero-section {
    padding: 5rem 1.5rem 4rem;
    text-align: center;
    background: linear-gradient(180deg, transparent, rgb(13 148 136 / 0.05));
  }

  .hero-container {
    max-width: 800px;
    margin: 0 auto;
  }

  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: rgb(245 158 11);
    color: white;
    border-radius: 2rem;
    font-size: 0.875rem;
    font-weight: 500;
    margin-bottom: 2rem;
  }

  .badge-icon {
    width: 1.25rem;
    height: 1.25rem;
  }

  .hero-title {
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 700;
    line-height: 1.2;
    color: var(--sl-color-text);
    margin-bottom: 1.5rem;
  }

  .highlight {
    color: rgb(13 148 136);
  }

  :global(.dark) .highlight {
    color: rgb(45 212 191);
  }

  .hero-subtitle {
    font-size: 1.125rem;
    color: #52525b;
    line-height: 1.7;
    margin-bottom: 2rem;
  }

  :global(.dark) .hero-subtitle {
    color: #a1a1aa;
  }

  .hero-ctas {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .cta-primary {
    padding: 0.875rem 1.75rem;
    background: rgb(13 148 136);
    color: white;
    border-radius: 0.5rem;
    font-weight: 500;
    text-decoration: none;
    transition: background 0.2s;
  }

  .cta-primary:hover {
    background: rgb(15 118 110);
  }

  .cta-secondary {
    padding: 0.875rem 1.75rem;
    background: transparent;
    border: 1px solid #d4d4d8;
    color: var(--sl-color-text);
    border-radius: 0.5rem;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.2s;
  }

  :global(.dark) .cta-secondary {
    border-color: #3f3f46;
  }

  .cta-secondary:hover {
    background: #f4f4f5;
  }

  :global(.dark) .cta-secondary:hover {
    background: #27272a;
  }

  /* Section common */
  .section-container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  .section-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--sl-color-text);
    text-align: center;
    margin-bottom: 0.5rem;
  }

  .section-subtitle {
    font-size: 1.125rem;
    color: #52525b;
    text-align: center;
    margin-bottom: 3rem;
  }

  :global(.dark) .section-subtitle {
    color: #a1a1aa;
  }

  /* Features Section */
  .features-section {
    padding: 5rem 0;
    background: #f4f4f5;
    border-top: 1px solid #e4e4e7;
  }

  :global(.dark) .features-section {
    background: #18181b;
    border-top-color: #27272a;
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }

  @media (max-width: 900px) {
    .features-grid {
      grid-template-columns: 1fr;
    }
  }

  .feature-card {
    background: var(--sl-color-bg);
    border: 1px solid #e4e4e7;
    border-radius: 1rem;
    padding: 2rem;
  }

  :global(.dark) .feature-card {
    border-color: #27272a;
  }

  .feature-icon {
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgb(13 148 136 / 0.1);
    border-radius: 0.75rem;
    margin-bottom: 1rem;
  }

  .feature-icon svg {
    width: 1.5rem;
    height: 1.5rem;
    color: rgb(13 148 136);
  }

  :global(.dark) .feature-icon svg {
    color: rgb(45 212 191);
  }

  .feature-card h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--sl-color-text);
    margin-bottom: 0.75rem;
  }

  .feature-card p {
    font-size: 0.95rem;
    color: #52525b;
    line-height: 1.6;
    margin: 0;
  }

  :global(.dark) .feature-card p {
    color: #a1a1aa;
  }

  /* Code Section */
  .code-section {
    padding: 5rem 0;
    background: #18181b;
    border-top: 1px solid #27272a;
    border-bottom: 1px solid #27272a;
  }

  .code-section .section-title,
  .code-section .section-subtitle {
    color: #fafafa;
  }

  .code-section .section-subtitle {
    color: #a1a1aa;
  }

  .code-tabs {
    max-width: 800px;
    margin: 0 auto;
  }

  .tab-buttons {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  .tab-btn {
    padding: 0.5rem 1rem;
    background: #27272a;
    border: 1px solid #3f3f46;
    border-radius: 0.375rem;
    color: #a1a1aa;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.2s;
  }

  .tab-btn:hover {
    background: #3f3f46;
    color: #fafafa;
  }

  .tab-btn.active {
    background: rgb(13 148 136);
    border-color: rgb(13 148 136);
    color: white;
  }

  .code-block {
    background: #09090b;
    border: 1px solid #27272a;
    border-radius: 0.75rem;
    overflow: hidden;
  }

  .code-block.hidden {
    display: none;
  }

  .code-block pre {
    margin: 0;
    padding: 1.5rem;
    overflow-x: auto;
  }

  .code-block code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
    font-size: 0.875rem;
    line-height: 1.6;
    color: #e4e4e7;
  }

  .code-comment {
    color: #71717a;
  }

  .code-keyword {
    color: rgb(139 92 246);
  }

  .code-string {
    color: rgb(74 222 128);
  }

  .code-number {
    color: rgb(251 191 36);
  }

  /* Limits Section */
  .limits-section {
    padding: 5rem 0;
  }

  .limits-table-wrapper {
    overflow-x: auto;
    margin-bottom: 1rem;
  }

  .limits-table {
    width: 100%;
    border-collapse: collapse;
    max-width: 700px;
    margin: 0 auto;
  }

  .limits-table th,
  .limits-table td {
    padding: 1rem 1.5rem;
    text-align: center;
    border-bottom: 1px solid #e4e4e7;
  }

  :global(.dark) .limits-table th,
  :global(.dark) .limits-table td {
    border-bottom-color: #27272a;
  }

  .limits-table th {
    font-weight: 600;
    color: var(--sl-color-text);
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .limits-table td {
    color: #52525b;
    font-size: 0.95rem;
  }

  :global(.dark) .limits-table td {
    color: #a1a1aa;
  }

  .limits-table td.tier-name {
    font-weight: 600;
    color: var(--sl-color-text);
    text-align: left;
  }

  .limits-table td.check {
    color: rgb(13 148 136);
  }

  :global(.dark) .limits-table td.check {
    color: rgb(45 212 191);
  }

  .limits-table td.dash {
    color: #a1a1aa;
  }

  .limits-note {
    text-align: center;
    color: #71717a;
    font-size: 0.875rem;
  }

  /* CTA Section */
  .cta-section {
    padding: 5rem 0;
    background: linear-gradient(180deg, rgb(13 148 136 / 0.05), transparent);
    text-align: center;
  }

  .cta-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--sl-color-text);
    margin-bottom: 1rem;
  }

  .cta-subtitle {
    font-size: 1.125rem;
    color: #52525b;
    margin-bottom: 2rem;
  }

  :global(.dark) .cta-subtitle {
    color: #a1a1aa;
  }

  .cta-buttons {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }
</style>
